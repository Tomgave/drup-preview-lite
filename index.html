<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drup – Aperçu v2</title>
  <meta name="description" content="Bienvenue sur Drup – La vente à la chandelle moderne.">
  <link rel="icon" href="/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --blue:#4169E1; /* Bleu roi */
      --black:#000000;
      --bg:#FAFAFA;
      --text:#0A0A0A;
      --muted:#6B7280;
      --border:#E5E7EB;
      --accent:#4169E1;
      --cta:#000000;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Poppins,system-ui,Arial,sans-serif; background:var(--bg); color:var(--text);}
    header{background:white; border-bottom:1px solid var(--border); position:sticky; top:0; z-index:10}
    .container{max-width:1100px; margin:0 auto; padding:16px;}
    .brand{display:flex; align-items:center; gap:12px; font-weight:800; font-size:22px; color:var(--black); letter-spacing:.5px;}
    .brand img{height:36px}
    .hero{padding:40px 0; text-align:center}
    h1{margin:0 0 10px 0; font-size:28px; font-weight:800}
    .muted{color:var(--muted)}
    .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:20px}
    @media (max-width:900px){.grid{grid-template-columns:1fr 1fr}}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}
    .card{background:#fff; border:1px solid var(--border); border-radius:16px; padding:18px; display:flex; flex-direction:column; gap:12px; box-shadow:0 8px 24px rgba(0,0,0,.06)}
    .thumb{background:#EEF2FF; border-radius:12px; height:190px; display:flex; align-items:center; justify-content:center; color:#334155; font-weight:700}
    .title{font-weight:600}
    .price{font-size:18px; font-weight:800}
    .timer{font-variant-numeric:tabular-nums; background:#E0E7FF; color:#1E3A8A; padding:6px 12px; border-radius:999px; display:inline-block; font-weight:600}
    .buy{background:var(--cta); color:white; padding:12px 18px; border:none; border-radius:999px; cursor:pointer; font-weight:800; letter-spacing:.3px; transition:transform .06s ease, opacity .2s}
    .buy:hover{opacity:.92; transform:translateY(-1px)}
    .link{color:var(--accent); text-decoration:none; font-weight:600}
    section{margin:32px 0}
    footer{padding:28px 0; color:var(--muted); text-align:center}
    .soon{background:#FFF7ED; border:1px dashed #FDBA74; border-radius:12px; padding:14px}
    .soon h3{margin:0 0 8px 0}
    .soon ul{margin:8px 0 0 18px}
    .chip{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:#E0E7FF; color:#1E3A8A; font-weight:600; font-size:12px}
    .tagline{font-weight:600; color:var(--black)}
  </style>
</head>
<body>
  <header>
    <div class="container brand">
      <img src="/logo.png" alt="Drup" />
      <span>DRUP</span>
    </div>
  </header>
  <main class="container">
    <section class="hero">
      <div class="chip">Aperçu</div>
      <h1 class="tagline">Bienvenue sur Drup – La vente qui baisse jusqu'à ce que vous craquiez.</h1>
      <p class="muted">Version de prévisualisation aux couleurs Bleu roi & Noir.</p>
      <p><a class="link" href="#live">Voir les ventes en direct ↓</a></p>
    </section>

    <section id="live">
      <h2>En vente maintenant</h2>
      <div class="grid" id="live-grid"></div>
    </section>

    <section class="soon">
      <h3>À venir sur Drup</h3>
      <ul id="soon-list" class="muted"></ul>
    </section>

    <section>
      <h2>Drup passés</h2>
      <ul class="muted" id="past-list"></ul>
    </section>
  </main>
  <footer>© Drup — MVP aperçu</footer>

<script>
const products = JSON.parse(localStorage.getItem('drup_live')||'[]');
const soon = JSON.parse(localStorage.getItem('drup_soon')||'[]');
const past = JSON.parse(localStorage.getItem('drup_past')||'[]');

const liveGrid = document.getElementById('live-grid');
function fmt(n){ return new Intl.NumberFormat('fr-FR',{minimumFractionDigits:2, maximumFractionDigits:2}).format(n); }
function pad(n){ return n.toString().padStart(2,'0'); }

function renderCard(p){
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <div class="thumb">Image</div>
    <div class="title">${p.name}</div>
    <div class="price"><span id="price-${p.id}">${fmt(p.start)}</span> EUR</div>
    <div class="timer"><span id="t-${p.id}">${pad(Math.floor(p.seconds/60))}:${pad(p.seconds%60)}</span> restantes</div>
    <button class="buy" id="b-${p.id}">Acheter maintenant</button>
  `;
  liveGrid.appendChild(card);

  let t = p.seconds;
  const step = (p.start - p.min) / p.seconds;
  const btn = card.querySelector('#b-'+p.id);
  let locked = false;
  btn.addEventListener('click', () => {
    if (locked) return;
    locked = true;
    btn.textContent = "Prix bloqué 15 min (simulation)";
    btn.disabled = true;
  });

  const iv = setInterval(()=>{
    t = Math.max(0, t-1);
    const remaining = `${pad(Math.floor(t/60))}:${pad(t%60)}`;
    document.getElementById('t-'+p.id).textContent = remaining;
    const priceNow = Math.max(p.min, p.start - step * (p.seconds - t));
    document.getElementById('price-'+p.id).textContent = fmt(priceNow);
    if(t<=0){ clearInterval(iv); }
  },1000);
}

products.forEach(renderCard);

const soonList = document.getElementById('soon-list');
soon.forEach(s => {
  const li = document.createElement('li');
  li.textContent = `${s.name} — mise en vente à ${s.at}`;
  soonList.appendChild(li);
});

const pastList = document.getElementById('past-list');
past.forEach(p => {
  const li = document.createElement('li');
  li.textContent = `${p.name} — vendue à ${p.price} EUR à ${p.time}`;
  pastList.appendChild(li);
});
</script>
</body>
</html>
